{% extends 'base.html' %}
{% load static %}

{% block title %}Nutritionists{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/nutritionists.css' %}">
{% endblock %}

{% block content %}

<div class="nutritionistspagecontainer py-4">

    <h2>Expert Nutritionists</h2>
    <p>Connect with certified nutrition professionals for expert guidance and support</p>

    <!-- NOTE -->
    <div class="alert mt-3">
        <strong>
            <i class="bi bi-info-circle-fill info-icon"></i>
            Note:
        </strong>
        Nutritionists are listed for informational purposes only.
    </div>

    <!-- SEARCH -->
    <div class="search-filter-box mt-4">
        <form method="get" class="d-flex gap-3">
            <input type="text" name="search" value="{{ search }}" placeholder="Search by name or keyword..."
                class="form-control">

            <select name="specialty" class="form-control">
                <option value="">All Specialties</option>
                <option value="weight" {% if specialty == 'weight' %}selected{% endif %}>Weight</option>
                <option value="dermatologist" {% if specialty == 'dermatologist' %}selected{% endif %}>Dermatologist</option>
                <option value="nutritionist" {% if specialty == 'nutritionist' %}selected{% endif %}>Nutritionist</option>
                <option value="general physician" {% if specialty == 'general physician' %}selected{% endif %}>General Physician</option>
                <option value="sports" {% if specialty == 'sports' %}selected{% endif %}>Sports Nutrition</option>
            </select>

            <input type="text" name="city" value="{{ city }}" placeholder="Enter city (e.g. Bahawalpur)"
                class="form-control">

            <button class="btn btn-success px-4">
                <i class="bi bi-search"></i> Search
            </button>
        </form>
    </div>

    <!-- LIST -->
    <div class="nutritionist-list mt-4">
        <div class="row justify-content-center">

            {% for n in nutritionists %}
            <div class="col-12 mb-4 d-flex justify-content-center">

                <div class="nutri-card">

                    <!-- HEADER -->
                    <div class="nutri-header">
                        <div class="nutri-header-img">
                            {% if n.image %}
                                <img src="{{ n.image.url }}" alt="Nutritionist Photo">
                            {% else %}
                                <div class="nutri-header-placeholder">
                                    <i class="bi bi-person-circle default-nutri-icon"></i>
                                </div>
                            {% endif %}
                        </div>

                        <div class="nutri-header-info">
                            <h3 class="nutri-name">{{ n.name }}</h3>
                            <span class="nutri-badge">{{ n.specialty }}</span>

                            <small class="text-muted">
                                <i class="bi bi-geo-alt-fill info-icon"></i>
                                {{ n.city }}
                                &nbsp;·&nbsp;
                                <i class="bi bi-briefcase-fill info-icon"></i>
                                {{ n.experience_years }} yrs experience
                            </small>
                        </div>
                    </div>

                    <!-- QUICK INFO -->
                    <div class="nutri-quick mt-3">
                        <strong>
                            <i class="bi bi-hospital-fill info-icon"></i>
                            {{ n.clinic_name }}
                        </strong><br>

                        <span class="subtext">
                            <i class="bi bi-geo-fill info-icon"></i>
                            {{ n.clinic_address }}
                        </span>
                    </div>

                    <!-- TOGGLE -->
                    <button class="btn btn-outline-success btn-sm mt-3" onclick="toggleDetails(this)">
                        <i class="bi bi-chevron-down toggle-icon"></i> View Details
                    </button>


                    <!-- EXPAND -->
                    <div class="nutri-expand">

                        <div class="expand-row">
                            <strong>
                                <i class="bi bi-mortarboard-fill info-icon"></i>
                                Degrees:
                            </strong>
                            <span>{{ n.degrees }}</span>
                        </div>

                        <div class="expand-row">
                            <strong>
                                <i class="bi bi-tags-fill info-icon"></i>
                                Category:
                            </strong>
                            <span>{{ n.get_category_display }}</span>
                        </div>

                        <div class="expand-row">
                            <strong>
                                <i class="bi bi-clock-fill info-icon"></i>
                                Available Timing:
                            </strong>
                            <span>{{ n.timing }}</span>
                        </div>

                        <div class="expand-row">
                            <strong>
                                <i class="bi bi-star-fill info-icon"></i>
                                Rating:
                            </strong>
                            <span>⭐ {{ n.rating }}/5</span>
                        </div>

                        <p class="expand-note mt-3">
                            <i class="bi bi-shield-check info-icon"></i>
                            This information is provided for awareness purposes only.
                        </p>

                    </div>

                </div>
            </div>

            {% empty %}
            <p class="text-center">
                <i class="bi bi-exclamation-circle"></i>
                No nutritionists match your search.
            </p>
            {% endfor %}

        </div>
    </div>

</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/nutritionists.js' %}"></script>
{% endblock %}